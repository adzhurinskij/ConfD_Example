//>>built
define("dojox/charting/action2d/MoveSlice","dojo/_base/connect dojo/_base/declare dojo/_base/array ./PlotAction dojo/fx/easing dojox/gfx/matrix dojox/gfx/fx dojox/lang/functional dojox/lang/functional/scan dojox/lang/functional/fold".split(" "),function(r,m,s,n,p,g,q,h){return m("dojox.charting.action2d.MoveSlice",n,{defaultParams:{duration:400,easing:p.backOut,scale:1.05,shift:7},optionalParams:{},constructor:function(b,h,d){d||(d={});this.scale="number"==typeof d.scale?d.scale:1.05;this.shift="number"==
typeof d.shift?d.shift:7;this.connect();b&&b.node&&(this._nodeL=r.connect(b.node,"onmouseout",this,function(a){if(this.anim)for(var b in this.anim)if(a=this.anim[b],"in"!==a.dir){a.action.stop(!0);this.anim[b]={dir:"in"};var c=(this.angles[a.index]+this.angles[a.index+1])/2,d=g.rotateAt(-c,a.cx,a.cy),c=g.rotateAt(c,a.cx,a.cy);this.anim[b].action=q.animateTransform({shape:a.shape,duration:this.duration,easing:this.easing,transform:[c,{name:"translate",start:[this.shift,0],end:[0,0]},{name:"scaleAt",
start:[this.scale,a.cx,a.cy],end:[1,a.cx,a.cy]},d]});this.anim[b].cx=a.cx;this.anim[b].cy=a.cy;this.anim[b].action.play()}}))},process:function(b){if(b.shape&&"slice"==b.element&&b.type in this.overOutEvents){if(!this.angles){var m=g._degToRad(b.plot.opt.startAngle);this.angles="number"==typeof b.run.data[0]?h.map(h.scanl(b.run.data,"+",0),"* 2 * Math.PI / this",h.foldl(b.run.data,"+",0)):h.map(h.scanl(b.run.data,"a + b.y",0),"* 2 * Math.PI / this",h.foldl(b.run.data,"a + b.y",0));this.angles=s.map(this.angles,
function(a){return a+m})}var d=b.index,a,e,c,k,f;a=(this.angles[d]+this.angles[d+1])/2;var n=g.rotateAt(-a,b.cx,b.cy),p=g.rotateAt(a,b.cx,b.cy);a=this.anim[d];var l;l="onmouseover"==b.type?"out":"in";if(a)if(a.dir!==l)a&&(a.action&&"playing"===a.action.status())&&a.action.stop(!0);else{if(a&&a.action&&"stopped"!==a.action.status())return}else this.anim[d]=a={};for(e in this.anim)c=this.anim[e],e!=d&&(c.action&&c.dir)&&"in"!==c.dir&&(c.action.stop(!0),this.anim[e]={dir:"in"},f=(this.angles[c.index]+
this.angles[c.index+1])/2,k=g.rotateAt(-f,c.cx,c.cy),f=g.rotateAt(f,c.cx,c.cy),this.anim[e].action=q.animateTransform({shape:c.shape,duration:this.duration,easing:this.easing,transform:[f,{name:"translate",start:[this.shift,0],end:[0,0]},{name:"scaleAt",start:[this.scale,c.cx,c.cy],end:[1,c.cx,c.cy]},k]}),this.anim[e].cx=c.cx,this.anim[e].cy=c.cy,this.anim[e].action.play());"out"===l?(k=0,f=this.shift,e=1,c=this.scale):(k=this.shift,f=0,e=this.scale,c=1);a.action=q.animateTransform({shape:b.shape,
duration:this.duration,easing:this.easing,transform:[p,{name:"translate",start:[k,0],end:[f,0]},{name:"scaleAt",start:[e,b.cx,b.cy],end:[c,b.cx,b.cy]},n]});a.dir=l;a.index=d;a.shape=b.shape;a.cx=b.cx;a.cy=b.cy;"onmouseout"==b.type&&r.connect(a.action,"onEnd",this,function(){delete this.anim[d]});a.action.play()}},reset:function(){delete this.angles},destroy:function(){this._nodeL&&(this._nodeL.remove(),delete this._nodeL);this.inherited(arguments)}})});
//# sourceMappingURL=MoveSlice.js.map